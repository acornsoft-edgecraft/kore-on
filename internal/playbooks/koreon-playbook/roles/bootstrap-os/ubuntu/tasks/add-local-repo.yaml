---
## Backup repo ------------------------------------------------------------------
- name: Backup /etc/apt/sources.list.d directory
  ansible.builtin.copy:
    remote_src: true
    src: "/etc/apt/sources.list.d"
    dest: "/etc/apt/sources.list.d.back-{{ ansible_date_time.iso8601_basic_short }}"

## Disable Repo list ---------------------------------------------------------------

## Add Local Repo ---------------------------------------------------------------
- name: Add local repository
  ansible.builtin.apt_repository:
    repo: "deb {{ (local_repository_url == '') | ternary('http://' + registry_ip + ':' + (local_repository_port | string), local_repository_url, omit) }} stable main"
    state: present
    filename: local-repo